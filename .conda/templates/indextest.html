<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Grocery Sales Tracker</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='stylestest.css') }}" />
</head>

<body>
    <h1 style="font-family: 'Courier New', Courier, monospace;">Grocery</h1>

    <div id="navbar">
        <a>LINK ONE</a>
        <a>LINK TWO</a>
        <a>LINK THREE</a>
        <a>LINK FOUR</a>
        <a>LINK FIVE</a>
    </div>

    <div id="searchContainer">
        <input
            type="text"
            id="searchIntake"
            placeholder="apple, orange, steak"
        />
        <button onclick="searchGrocery()">Search</button>
    </div>

    <div class="mainContainer">
        <div id="storeContainer">
            <h2>Enter Store</h2>
            <input type="text" id="address_input" placeholder="Store Address" />
            <button onclick="queryAddress()">Find Stores</button>

            <div id="storeList">STORE LIST</div>
        </div>

        <div id="groceryContainer">
            <h2>PLACE HOLDER</h2>
            <button onclick="displayAddresses()">Test Button</button>
        </div>
    </div>

    <div>
        <div> <!--this should be the category--></div>
        <div id="queriedList" style="background-color: white; height: 250px;">

        </div>
    </div>
    

    <script>
        let all_addresses = ["test", "test"];
        let fake_results = ["item1", "item2", "item3"];

        async function makeList(input){
            let element = document.getElementById("queriedList");
            // context = "find/" + input
            
            await fetch("/test/" + input)
                .then(response => response.json())
                .then(data => {
                    console.log("Value from Flask:", data.value);
                    fake_results.push(data.searchQ)
                    console.log("before: " + fake_results)
                });

            string = ""
            for(i = 0; i < fake_results.length; i++) {
                console.log("after: " + fake_results)
                string += "<p class=\"queriedItems\">" + fake_results[i] + "</p>";
            }

                
            // fetch(IP:PORT, context)
            // this should return all item prices in an Array?
            
            element.innerHTML = string;
        }

        function helper() {
            
        }

        function queryAddress() {
            const context = document.getElementById("address_input");
            all_addresses.push(context.value);
            console.log(all_addresses + " " + context.value);
            context.value = "";
        }

        function displayAddresses() {
            const list = document.getElementById("storeList");

            if (all_addresses.length === 0) {
                list.innerHTML = "<p>No locations added.</p>";
                return;
            }

            list.innerHTML = all_addresses
                .map(addr => `<div><button onclick="addLocation('${addr}')">${addr}</button></div>`)
                .join("");

            console.log(list.innerHTML)
        }

        function addLocation(address) {
            console.log("Selected store:", address);
        }

        function searchGrocery() {
            const input = document.getElementById("searchIntake").value;
            console.log("Searching for:", input);
            makeList(input);
        }
    </script>
</body>
</html>

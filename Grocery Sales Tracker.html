<!DOCTYPE html>
<!-- saved from url=(0022)http://10.140.189.214/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grocery Sales Tracker</title>
    <link rel="stylesheet" href="./Grocery Sales Tracker_files/stylestest.css">
</head>

<body>
    <h1 style="font-family: &#39;Courier New&#39;, Courier, monospace;">Grocery</h1>

    <div id="navbar">
        <a>LINK ONE</a>
        <a>LINK TWO</a>
        <a>LINK THREE</a>
        <a>LINK FOUR</a>
        <a>LINK FIVE</a>
    </div>

    <div id="searchContainer">
        <input type="text" id="searchIntake" placeholder="apple, orange, steak">
        <button onclick="searchGrocery()">Search</button>
    </div>

    <div class="mainContainer">
        <div id="storeContainer">
            <h2>Enter Store</h2>
            <input type="text" id="address_input" placeholder="Store Address">
            <button onclick="queryAddress()">Find Stores</button>

            <div id="storeList">STORE LIST</div>
        </div>

        <div id="groceryContainer">
            <h2>PLACE HOLDER</h2>
            <button onclick="displayAddresses()">Test Button</button>
        </div>
    </div>

    <div style="background-color: white;">
        <div id="queriedList" style="height: 250px; width: 50%;">
            <table id="dataTable" style="width:50px;">
                <tbody><tr class="dataComponents">
                    <th>Item</th>
                    <th>Price</th>
                    <th>Store</th>
                    <th>Query Value</th>
                </tr>
            </tbody></table>

        </div>
        <div style="width: 50%;"></div>
    </div>
    

    <script>
        let item_names = [];
        let item_prices = []
        let store_names = []
        let query_values = []

        async function makeList(input){
            let element = document.getElementById("dataTable");
            // context = "find/" + input
            
            await fetch("/test/" + input)
                .then(response => response.json())
                .then(data => {
                    alert("Value from Flask: " + data.value);
                    console.log("RAW DATA:", data);
                    item_names.push(...data.Item_Name);
                    item_prices.push(...data.Item_Price);
                    store_names.push(...data.Store_Name);
                    query_values.push(...data.Query_Value);
                });

            let string = ""
            for(i = 0; i < item_names.length; i++) {
                str1 = "<th class=\"dataComponents\">" + item_names[i]+ "</th>"
                str2 = "<th class=\"dataComponents\">"+ item_prices[i] + "</th>"
                str3 = "<th class=\"dataComponents\">"+ store_names[i] + "</th>"
                str4 = "<th class=\"dataComponents\">"+ query_values[i] + "</th>"
                string += "<tr>" + str1 + str2 + str3 + str4 + "</tr>";
            }

            element.innerHTML += string;
        }

        function queryAddress() {
            const context = document.getElementById("address_input");
            all_addresses.push(context.value);
            console.log(all_addresses + " " + context.value);
            context.value = "";
        }

        function displayAddresses() {
            const list = document.getElementById("storeList");

            if (all_addresses.length === 0) {
                list.innerHTML = "<p>No locations added.</p>";
                return;
            }

            list.innerHTML = all_addresses
                .map(addr => `<div><button onclick="addLocation('${addr}')">${addr}</button></div>`)
                .join("");

            console.log(list.innerHTML)
        }

        function addLocation(address) {
            console.log("Selected store:", address);
        }

        function searchGrocery() {
            const input = document.getElementById("searchIntake").value;
            console.log("Searching for:", input);
            makeList(input);
        }
    </script>

<div id="hl-aria-live-message-container" aria-live="polite" class="visually-hidden"></div><div id="hl-aria-live-alert-container" role="alert" aria-live="assertive" class="visually-hidden"></div></body></html>